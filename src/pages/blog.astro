---
import "../styles/styles.css";
import BaseLayout from "../layouts/BaseLayout.astro";
import BlogPost from "../components/BlogPost.astro";
import { getCollection } from "astro:content";

const allPosts = await getCollection("blog");

const tags = [...new Set(allPosts.map((post: any) => post.data.tags).flat())];

const pageTitle = "All posts";
---

<BaseLayout pageTitle={pageTitle}>
  <div>
    <h2>Tags:</h2>
    <div class="tags">
      {
        tags.map((tag) => (
          <p class="tag">
            <a href={`/tags/${tag}`}>{tag}</a>
          </p>
        ))
      }
    </div>
  </div>
  <div>
    <h2>Posts:</h2>
    <ul class="posts-list">
      {
        allPosts.map((post: any) => (
          <BlogPost url={`/posts/${post.id}/`} title={post.data.title} />
        ))
      }
    </ul>
  </div>
</BaseLayout>
